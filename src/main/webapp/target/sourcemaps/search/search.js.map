{"version":3,"sources":["search/search.js"],"names":[],"mappings":";;;oFAYM,MAAM;;;sCAZJ,SAAS;mCAAE,MAAM;;;;oDAEjB,UAAU;;6CACV,KAAK;;;;;;;AASP,kBAAM;AAEG,yBAFT,MAAM,CAEI,MAAM,EAAE;;;AAChB,wBAAI,CAAC,KAAK,GAAG,MAAM,CAAC;AACpB,wBAAI,CAAC,KAAK,CAAC,aAAa,GAAG,WAAW,EAAE,CAAC,WAAW,EAAE,IAAI,SAAS,CAAC;AACpE,wBAAI,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;AACtB,wBAAI,CAAC,UAAU,EAAE,CAAC;iBACrB;;yCAPC,MAAM;;2BAUE,sBAAE;AACR,qCAAa,EAAE,CAAC,qBAAqB,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;qBAC1E;;;2BAEO,oBAAE;AACN,qCAAa,EAAE,CAAC,iBAAiB,CAAC,gBAAgB,EAAE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;AACvF,4BAAI,CAAC,mBAAmB,EAAE,CAAC;qBAC9B;;;2BAEkB,+BAAE;AACjB,qCAAa,EAAE,CAAC,UAAU,CAAC,2BAA2B,EAAC,EAAE,CAAC,CAAC;qBAC9D;;;2BAEgB,2BAAC,IAAI,EAAC;AACnB,4BAAI,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;AACzC,4BAAI,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC;qBACvB;;;2BAES,oBAAC,IAAI,EAAC;AACZ,4BAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,EAAC;AAC7B,gCAAI,CAAC,KAAK,CAAC,KAAK,GAAG,sBAAsB,CAAC;yBAC7C,MAAI;AACD,iCAAK,EAAE,CAAC,EAAE,CAAC,UAAU,EAAE,EAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,EAAC,CAAC,CAAC;AAC9C,gCAAI,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;yBACzB;qBACJ;;;2BAEY,uBAAC,QAAQ,EAAC;AACnB,6BAAI,IAAI,CAAC,GAAC,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAC;AAC1C,gCAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,QAAQ,IAAI,QAAQ,EAAC;AACxC,uCAAO,IAAI,CAAC;6BACf;yBACJ;AACD,+BAAO,KAAK,CAAC;qBAChB;;8BA5CC,MAAM;AAAN,sBAAM,GADX,MAAM,CAAC,QAAQ,CAAC,CACX,MAAM,KAAN,MAAM;AAAN,sBAAM,GAJX,SAAS,CAAC;AACP,4BAAQ,EAAE,QAAQ;AAClB,4BAAQ,EAAE,QAAQ,EAAE,CAAC,CAEnB,MAAM,KAAN,MAAM;uBAAN,MAAM;;;+BAkDG,MAAM","file":"../../search/search.js","sourcesContent":["import {Component, Inject} from '../ngDecorators';\nimport template from './search.html!text';\nimport {ROOM_STATE} from \"../commons/componentConstants\";\nimport {state} from \"../commons/externalServices\";\nimport authService from '../commons/authService';\nimport socketService from '../commons/socketService';\nimport './search.css!';\n\n@Component({\n    selector: 'search',\n    template: template })\n@Inject('$scope')\nclass Search{\n\n    constructor($scope) {\n        this.scope = $scope;\n        this.scope.authenticated = authService().getUsername() != undefined;\n        this.scope.rooms = {};\n        this.initSocket();\n    }\n\n\n    initSocket(){\n        socketService().connectToSearchSocket().then(this.getRooms.bind(this));\n    }\n\n    getRooms(){\n        socketService().subscribeToSearch(\"/message/rooms\", this.roomUpdateHandler.bind(this));\n        this.sendGetRoomsRequest();\n    }\n\n    sendGetRoomsRequest(){\n        socketService().sendSearch(\"/app/searchRooms/getRooms\",{});\n    }\n\n    roomUpdateHandler(data){\n        this.scope.rooms = JSON.parse(data.body);\n        this.scope.$apply();\n    }\n\n    createRoom(room){\n        if(this.isRoomCreated(room.name)){\n            this.scope.error = \"Room already created\";\n        }else{\n            state().go(ROOM_STATE, {roomName: room.name});\n            this.scope.error = \"\";\n        }\n    }\n\n    isRoomCreated(roomName){\n        for(let i=0; i < this.scope.rooms.length; i++){\n            if(this.scope.rooms[i].roomName == roomName){\n                return true;\n            }\n        }\n        return false;\n    }\n\n\n\n}\n\nexport default Search;"],"sourceRoot":"/"}